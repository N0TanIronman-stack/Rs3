<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rs3 Stats Detector</title>
  <link rel="stylesheet" type="text/css" href="https://runeapps.org/nis/nis.css">
  <script src="https://runeapps.org/alt1lib.js"></script>
</head>
<body class="nis">
  <!-- Main Border Container -->
  <div class="nismainborder nisborder" style="padding: 20px; position: relative;">
    <h2>Alt1 Stats Detector</h2>
    <button onclick="startFinder()">Start Stats Finder</button>
    <div id="output" style="margin-top:10px; font-weight:bold; color:lime;"></div>
    <div><p> "Version 0.0.1" </p></div>
  </div>

  <script>
let statsReader = new a1lib.ImageDetect("./statanchor.png");
let statsPos = null;
let findStats = null;

function updateOutput(msg) {
    console.log(msg);
    document.getElementById("output").innerText = msg;
}

function startFinder() {
    if (!window.alt1) { alert("Not running in Alt1!"); return; }
    if (!alt1.permissionPixel) { alert("Pixel permission not granted!"); return; }

    statsReader.load().then(() => {
        updateOutput("Anchor image loaded âœ…");
        console.log("Anchor img:", statsReader.img);

        // Overlay the anchor for reference
        statsReader.overLay(200, 200, 10000);

        findStats = setInterval(async function () {
            try {
                const matches = await statsReader.find();
                console.log("Matches found:", matches);

                if (matches.length > 0) {
                    statsPos = matches[0];
                    clearInterval(findStats);

                    alt1.overLayRect([255,0,0,255], statsPos.x, statsPos.y, 150, 200, 5000, 3);
                    alt1.overLayText("Stats Found", [255,255,0,255], 20, statsPos.x, statsPos.y - 25, 5000);

                    updateOutput(`Stats window found at X: ${statsPos.x} Y: ${statsPos.y}`);
                } else {
                    updateOutput("Searching for stats window...");
                }
            } catch(err) {
                console.error("Error during search:", err);
                updateOutput("Error during search");
            }
        }, 1000);

    }).catch(err => {
        console.error("Error loading anchor:", err);
        updateOutput("Error loading anchor image.");
    });
}
</script>
</body>
</html>
