<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RS3 Skills Detector</title>
<script src="https://runeapps.org/alt1lib.js"></script>
<style>
#status { margin-top: 10px; font-weight: bold; color: lime; }
#debug { margin-top: 10px; font-size: 12px; white-space: pre-line; color: #ccc; }
button { margin-top: 10px; }
</style>
</head>
<body>
<h2>RS3 Skills Detector</h2>
<button id="startBtn">Start Scan</button>
<div id="status">Waitingâ€¦</div>
<div id="debug"></div>

<script>
const startBtn = document.getElementById("startBtn");
const statusEl = document.getElementById("status");
const debugEl = document.getElementById("debug");

function setStatus(msg, color="lime") {
    statusEl.innerText = msg;
    statusEl.style.color = color;
}

function setDebug(msg) {
    debugEl.innerText = msg;
}

// Core scan function
function startScan() {
    // Wait until alt1.capture exists
    const interval = setInterval(() => {
        if (window.alt1 && alt1.capture) {
            clearInterval(interval);
            scanScreen(alt1.capture);
        }
    }, 100);
}

function scanScreen(capture) {
    const screenW = alt1.rsWidth || 0;
    const screenH = alt1.rsHeight || 0;
    let x = 0, y = 0;
    const tileSize = 300;

    function scanChunk() {
        if (y >= screenH) return;

        const w = Math.min(tileSize, screenW - x);
        const h = Math.min(tileSize, screenH - y);

        const img = capture.capture(x, y, w, h);
        const pixels = img.toData();

        // Example: detect bright red pixels
        for (let i = 0; i < pixels.length; i += 4) {
            let r = pixels[i], g = pixels[i+1], b = pixels[i+2];
            if (r > 200 && g < 80 && b < 80) {
                let px = (i/4) % w;
                let py = Math.floor((i/4)/w);
                let absX = x + px, absY = y + py;
                alt1.overLayRect(a1lib.mixcolor(255,0,0), absX-5, absY-5, 20,20,5000,3);
            }
        }

        x += tileSize;
        if (x >= screenW) { x = 0; y += tileSize; }
        setTimeout(scanChunk, 100);
    }

    scanChunk();
}

startBtn.addEventListener("click", startScan);
</script>
</body>
</html>
